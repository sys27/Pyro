@if (issue$ | async; as issue) {
  <div class="grid m-4">
    <div class="col-12 text-2xl">
      <div class="flex flex-row gap-2">
        <span class="text-bold">{{ issue.title }}</span>
        <span class="text-400">#{{ issue.issueNumber }}</span>
        <div class="flex-grow-1"></div>
        <div>
          <p-button
            routerLink="edit"
            label="Edit"
            icon="pi pi-pencil"
            [disabled]="!(canEdit$ | async)"
            [outlined]="true" />
        </div>
      </div>
    </div>

    <div class="col-12 grid">
      <div class="col-10">
        @if (comments$ | async; as comments) {
          <div class="flex flex-column gap-2">
            @for (comment of comments; track comment.id) {
              <comment-view
                [comment]="comment"
                [repositoryName]="repositoryName()"
                [issue]="issue"
                (commentAdded)="commentAdded()" />
            }
          </div>
        }

        @if (canEdit$ | async) {
          <div class="mt-2">
            <comment-new
              [repositoryName]="repositoryName()"
              [issue]="issue"
              (commentAdded)="commentAdded()" />
          </div>
        }
      </div>
      <div class="col-2">
        <div>
          <div>Status:</div>
          <div>
            <p-tag
              [value]="issue.status.name"
              [rounded]="true"
              [style]="{
                background: issue.status.color | color,
                color: issue.status.color | luminance,
              }" />
          </div>
        </div>

        <p-divider />

        <div>
          <div>Assignee:</div>
          <div class="flex flex-row gap-2">
            <span class="pi pi-user"></span>
            <span>{{ issue.assignee?.name ?? 'Unassigned' }}</span>
          </div>
        </div>

        <p-divider />

        <div>
          <div>Author:</div>
          <div class="flex flex-row gap-2">
            <span class="pi pi-user"></span>
            <span>{{ issue.author.name }}</span>
          </div>
        </div>

        <p-divider />

        <div>
          <div>Created At:</div>
          <div>{{ issue.createdAt | date: 'short' }}</div>
        </div>

        <p-divider />

        <div>
          <div>Labels:</div>
          <div class="flex flex-column gap-2">
            @for (label of issue.labels; track label.id) {
              <p-tag
                [value]="label.name"
                [rounded]="true"
                [style]="{ background: label.color | color, color: label.color | luminance }" />
            } @empty {
              <span>No Labels</span>
            }
          </div>
        </div>

        <p-divider />

        <div>
          @if (issue.isLocked) {
            <p-button
              label="Unlock"
              icon="pi pi-lock-open"
              severity="secondary"
              [outlined]="true"
              (click)="unlockIssue()"
              [disabled]="!(canManage$ | async)" />
          } @else {
            <p-button
              label="Lock"
              icon="pi pi-lock"
              severity="secondary"
              [outlined]="true"
              (click)="lockIssue()"
              [disabled]="!(canManage$ | async)" />
          }
        </div>
      </div>
    </div>
  </div>
}
